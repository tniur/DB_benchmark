# 4queries benchmark

---
## Запуск

**1. Необходимо установить библиотеки:**
- psycopg2
- sqlite (поставляется вместе с питоном, устанавливать не нужно)
- duckdb
- pandas

**2. В файле config.py необходимо указать:**
- Количество запусков бенчмарка
- Параметры подключения к Postgres
- Абсолютные пути к датасету (в двух форматах: db и csv)
- Имя таблицы, к нему чувствительны Postgres и SQLite (по факту это имя файла с БД)
- Отдельно необходимо загрузить датасет в Postgres (например через pgAdmin)

**3. Запустить main.py**

---
## Исследование

В ходе лабораторной работы поработал с 4 библиотеками: 
- **psycopg2 (Postgress)**
- **SQLite**
- **DuckDB**
- **Pandas.**

~~(с библиотекой SQLAlchemy, к сожалению, нормально не успел разобраться)~~
### Впечатления
#### Postgress
- Одна из самых медленных по скорости выполнения запросов 
- Неудобное и муторное подключение
- Привычные и очевидные SQL запросы
#### SQLite
- Не требует установки
- Более удобный *connection*
- Показала худшие результаты по времени :(
#### DuckDB
- Очень обрадовало чтение csv
- Удобное и простое подключение
- Подозрительная (на первый взгляд) скорость, но необходимо заранее создать таблицу и спарсить в нее csv
- Самая быстрая из всех рассмотренных

#### Pandas
- Мой фаворит (в виду приятного использования)
- Быстра и проста в подключении
- Сравнительно хорошая скорость (2 место по моим тестам)
- Удобный и более очевидный (имхо) синтаксис запросов, по сравнению с SQL like expressions

---
## Статистика скорости

- Измерения проводились на части датасета [**New York City Taxi**](https://github.com/toddwschneider/nyc-taxi-data)
- Размер данных приблизительно **2Gb** (nyc_yellow_big)
- Для статистики производилось 15 запусков и вычислялось среднее значение
- Измерения скорости приводится в секундах

### Таблица


![table.png](chart_image%2Ftable.png)
### Графики
В виду значительной разницы между скоростью работы SQLite и DuckDB, последний практически незаметен на графике. Привожу один график в двух масштабах оси секунд.

![chart1.png](chart_image%2Fchart1.png)

![chart2.png](chart_image%2Fchart2.png)